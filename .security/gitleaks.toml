# title = "Peer Web Frontend Gitleaks Config"

[[rules]]
id = "web-catch-all"
description = "Catch likely secrets in Web/React code (.env, API keys, Firebase, JWT, etc.)"
regex = '''(?i)(ghp_[0-9A-Za-z]{36}|github_pat_[0-9A-Za-z_]{20,}|glpat-[0-9A-Za-z\-_]{20}|AKIA[0-9A-Z]{16}|ASIA[0-9A-Z]{16}|AIza[0-9A-Za-z\-_]{35}|AAAA[A-Za-z0-9_-]{5,}:[A-Za-z0-9_-]{20,}|sk_live_[0-9a-zA-Z]{24}|pk_live_[0-9a-zA-Z]{24}|eyJ[A-Za-z0-9_-]+\.[A-Za-z0-9._-]+\.[A-Za-z0-9._-]+|-----BEGIN( RSA| DSA| EC| OPENSSH)? PRIVATE KEY-----)'''
tags = ["key", "secret", "frontend", "react"]

[pathDenylist]
description = "Exclude noisy generated/test files for web builds"
regexes = [
  '''^node_modules/.*''',
  '''^dist/.*''',
  '''^build/.*''',
  '''^\.next/.*''',
  '''^coverage/.*''',
  '''^\.github/workflows/.*''',
  '''^tests?/.*''',
  '''^public/.*''',
  '''^\.env.*$'''
]

[allowlist]
description = "Ignore common DOM and React expressions flagged by entropy rule"
regexes = [
  '''document\.getElementById''',
  '''document\.querySelector''',
  '''window\.querySelector''',
  '''window\.lastBoostedCard\.querySelector''',
  '''addEventListener''',
  '''removeEventListener''',
  '''classList\.toggle''',
  '''createElement''',
  '''setAttribute''',
  '''getAttribute''',
  '''ReactDOM\.render''',
  '''useState''',
  '''useEffect''',
  '''localStorage''',
  '''sessionStorage''',
  '''navigator\.''',
  '''window\.''',
  '''console\.log''',
  '''style\.[A-Za-z]+''',
  '''passwordStrengthDiv\.classList\.toggle''',
  '''AKIAAwABBAkAAABqALUA''',
  '''aKIAYNcRFbrKYzmZ6cmx''',
  '''AkIAglpDgEIAAEFCAFpA'''
]
