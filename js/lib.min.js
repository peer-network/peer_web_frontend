function getCookie(e){const t=`; ${document.cookie}`,o=t.split(`; ${e}=`);if(2===o.length)return o.pop().split(";").shift()}function createModal({title:e="",message:t="",buttons:o=[],type:n="info",textarea:a=!1,dontShowOption:r=!1,typeKey:s=null,svg:l=null}){console.log("dontShowOption ",r),console.log("typeKey ",s);const i=JSON.parse(localStorage.getItem("modalDoNotShow"))||{};return console.log("savedSettings ",i),s&&r&&!0===i[s]?Promise.resolve({button:1,dontShow:!0}):new Promise(c=>{const d=document.createElement("div");d.classList.add("modal-container");const u=r?'\n        <div class="modal-checkbox">\n          <label for="dont-show-checkbox">Do not show this message again</label>\n          <input type="checkbox" id="dont-show-checkbox" />\n        </div>':"";d.innerHTML=`\n      <div class="modal-content ${n}">\n        <span class="modal-close">&times;</span>\n       ${l?`<span class="modal-icon">${l}</span>`:""}\n        <h2 class="modal-title xxl_font_size">${e}</h2>\n        <p class="modal-message xl_font_size">${t}</p>\n        ${u}\n        ${a?`<textarea class="modal-textarea" placeholder="${"object"==typeof a&&a.placeholder?a.placeholder:""}">${"object"==typeof a&&a.value?a.value:""}</textarea>`:""}\n        <div class="modal-buttons">\n          ${o.map((e,t)=>{const o="string"==typeof e?e:e.text,n="object"==typeof e&&e.className?` ${e.className}`:"";return`<button class="modal-button${n}" data-index="${t}">${o}</button>`}).join("")}\n        </div>\n      </div>\n    `,document.body.appendChild(d),setTimeout(()=>d.classList.add("modal-show"),10);const m=r?d.querySelector("#dont-show-checkbox"):null,f=d.querySelector(".modal-textarea"),g=d.querySelectorAll(".modal-button");g.forEach(e=>{e.addEventListener("click",e=>{e.currentTarget.focus();const t=Number(e.target.getAttribute("data-index")),o=!!m&&m.checked;r&&o&&s&&1===t&&(i[s]=!0,localStorage.setItem("modalDoNotShow",JSON.stringify(i)),console.log("i am in first  if ")),c(f?{button:t,value:f.value,dontShow:o}:r?{button:t,dontShow:o}:{button:t}),closeModal(d)})});const h=d.querySelector(".modal-close");h.addEventListener("click",()=>{const e=!!m&&m.checked;c(r?{button:null,dontShow:e}:{button:null}),closeModal(d)}),f&&setTimeout(()=>{f.focus()},10)})}function closeModal(e){e.classList.add("modal-fade-out"),setTimeout(()=>{e.remove()},300)}function userfriendlymsg(e){let t;return t=e in responsecodes.data?responsecodes.data[e].userFriendlyComment:e,t}function info(e,t="",o=!1){return createModal({title:e,message:userfriendlymsg(t),buttons:[{text:"Cancel",className:"btn-transparent"},{text:"Confirm",className:"btn-white"}],type:"info",dontShowOption:o})}function Merror(e,t="",o=!1){return createModal({title:e,message:userfriendlymsg(t),buttons:["OK"],type:"error",dontShowOption:o})}function warnig(e,t="",o=!1){return createModal({title:e,message:userfriendlymsg(t),buttons:[{text:"Cancel",className:"btn-transparent"},{text:"Confirm",className:"btn-white"}],type:"warning",dontShowOption:o})}function confirm(e,t="",o=!1,n=null,a=null){return createModal({title:e,message:userfriendlymsg(t),buttons:[{text:"No",className:"btn-white"},{text:"Yes",className:"btn-blue"}],type:"warning",dontShowOption:o,typeKey:n,svg:a})}function setScrollPercent(e,t,o=!1){const n=Math.min(100,Math.max(0,t)),a=e.scrollHeight-e.clientHeight,r=a*(n/100);o?e.scrollTo({top:r,behavior:"smooth"}):e.scrollTop=r}function formatNumber(e){return e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e.toString()}function sanitizeString(e){return e.replace(/[^A-Za-z0-9 \-_]/g,"")}function extractAfterComma(e){return e.includes(",")?e.split(",")[1]:e}async function loadTextFile(e,t){try{const o=await fetch(e),n=await o.text();t.innerText=n}catch(e){t.innerText="Fehler beim Laden der Datei."}}function sliceTextAtWord(e,t=140){if(e.length<=t)return e;const o=e.slice(0,t),n=o.lastIndexOf(" ");return o.slice(0,n)}async function readBytes(e,t){try{const o=await fetch(e),n=o.body.getReader(),{value:a,done:r}=await n.read();if(r)return;const s=a.slice(0,t),l=new TextDecoder("utf-8").decode(s);return l}catch(e){console.error("Fehler beim Lesen der Datei:",e)}}function formatDate(e){const t=new Date(e),o={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return t.toLocaleString("de-DE",o).replace(",","").replace(/\./g,".")}function timeAgo(e){const t=Date.now(),o=new Date(adjustForDSTAndFormat(e)),n=t-o-36e5,a=Math.floor(n/1e3),r=Math.floor(a/60),s=Math.floor(r/60),l=Math.floor(s/24),i=Math.floor(l/7),c=Math.floor(l/30),d=Math.floor(l/365);return a<60?`${a} second`+(a>1?"s ago":" ago"):r<60?`${r} minute`+(r>1?"s ago":" ago"):s<24?`${s} hour`+(s>1?"s ago":" ago"):l<7?`${l} day`+(l>1?"s ago":" ago"):i<4?`${i} week`+(i>1?"s ago":" ago"):c<12?`${c} month`+(c>1?"s ago":" ago"):`${d} year`+(d>1?"s ago":" ago")}function adjustForDSTAndFormat(e){const t={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},o=new Date(e.replace(" ","T")),n=new Date(o.getFullYear(),0,1),a=new Date(o.getFullYear(),6,1),r=Math.max(n.getTimezoneOffset(),a.getTimezoneOffset())!==o.getTimezoneOffset();return o.setHours(o.getHours()+1),r&&o.setHours(o.getHours()+1),o.toLocaleString(void 0,t).replace(",","").replace(/\./g,".")}function tempMedia(e){const t=domain.replace("://","://media.")+e;return t}async function fetchHelloData(e=null){const t=getCookie("authToken"),o=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${t}`});let n=JSON.stringify({query:`query Hello {\n      hello {\n          currentuserid\n      }\n      getProfile(userid: ${e}) {\n        status\n        ResponseCode\n        affectedRows {\n            id\n            username\n            status\n            slug\n            img\n            biography\n            isfollowed\n            isfollowing\n            amountposts\n            amounttrending\n            amountfollowed\n            amountfollower\n            amountfriends\n            amountblocked\n        }\n      }\n    }`,variables:{}});var a={method:"POST",headers:o,body:n,redirect:"follow"};try{const e=await fetch(GraphGL,a),t=await e.json();return t}catch(e){throw console.log("error",e),e}}async function hello(){const e=getCookie("authToken"),t=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${e}`}),o=JSON.stringify({query:"query Hello {\n      hello {\n          currentuserid\n      }\n  }"}),n={method:"POST",headers:t,body:o,redirect:"follow"};try{const e=await fetch(GraphGL,n),t=await e.json();if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);if(t.errors)throw new Error(t.errors[0].message);return document.cookie=`userID=${t.data.hello.currentuserid}; path=/; secure; SameSite=Strict`,t.data.hello}catch(e){throw console.error("Error:",e.message),e}}async function getUser(){const e=await fetchHelloData(),t=getCookie("userID");if(t){document.querySelectorAll(".username").forEach(t=>{t.innerText=e.data.getProfile.affectedRows.username}),document.querySelectorAll(".slug").forEach(t=>{t.innerText="#"+e.data.getProfile.affectedRows.slug});const t=document.getElementById("userPosts");t&&(t.innerText=e.data.getProfile.affectedRows.amountposts);const o=document.getElementById("followers");o&&(o.innerText=e.data.getProfile.affectedRows.amountfollower);const n=document.getElementById("following");n&&(n.innerText=e.data.getProfile.affectedRows.amountfollowed);const a=document.getElementById("Peers");a&&(a.innerText=e.data.getProfile.affectedRows.amountfriends);document.querySelectorAll(".profilbild").forEach(t=>{t.onerror=function(){this.src="svg/noname.svg"},t.src=e.data.getProfile.affectedRows.img?tempMedia(e.data.getProfile.affectedRows.img.replace("media/","")):"svg/noname.svg"})}else{const e=document.getElementById("profil-container"),t=document.getElementById("profil-login");e.classList.add("none"),t.classList.remove("none")}return e}let domain=document.getElementById("config").dataset.host;const GraphGL=domain+"/graphql";let responsecodes=[];fetch("./json/response-codes.json").then(e=>e.json()).then(e=>{responsecodes=e});