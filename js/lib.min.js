async function likeComment(e){if(!await LiquiudityCheck(likeCost,"Like Comment",like))return!1;const t=getCookie("authToken"),n=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${t}`});var o=JSON.stringify({query:`mutation LikeComment {\n            likeComment(commentid: "${e}") {\n                status\n                ResponseCode\n            }\n        }`,variables:{}}),a={method:"POST",headers:n,body:o,redirect:"follow"};return fetch(GraphGL,a).then(e=>e.json()).then(e=>{if("error"==e.data.likeComment.status)throw new Error(userfriendlymsg(e.data.likeComment.ResponseCode));return!0}).catch(e=>(Merror(userfriendlymsg(result.data.likeComment.ResponseCode)),!1))}async function createComment(e,t,n=null){if(!await LiquiudityCheck(commentCost,"Comment Post",1))return!1;const o=getCookie("authToken"),a=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${o}`}),r="\n    mutation CreateComment($postId: ID!, $content: String!, $parentId: ID) {\n      createComment(action: COMMENT, postid: $postId, content: $content, parentid: $parentId) {\n        status\n        counter\n        ResponseCode\n        affectedRows {\n          commentid\n          userid\n          content\n          createdat\n          amountlikes\n          amountreplies\n          isliked\n          postid\n          parentid\n          user {\n              id\n              username\n              slug\n              img\n              isfollowed\n              isfollowing\n          }\n        }\n      }\n    }\n  ",s={postId:e,content:t,parentId:n};return fetch(GraphGL,{method:"POST",headers:a,body:JSON.stringify({query:r,variables:s})}).then(e=>e.json()).then(e=>(console.log("Antwort:",e),e)).catch(e=>(console.error("Fehler:",e),e))}async function fetchChildComments(e){const t=getCookie("authToken"),n=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${t}`}),o="\n  query listChildComments($parent: ID!) {\n    listChildComments(parent: $parent) {\n        status\n        counter\n        ResponseCode\n        affectedRows {\n            commentid\n            userid\n            postid\n            parentid\n            content\n            amountlikes\n            isliked\n            createdat\n            user {\n                id\n                username\n                img\n                isfollowed\n                isfollowing\n            }\n        }\n    }\n  }",a={parent:e};return fetch(GraphGL,{method:"POST",headers:n,body:JSON.stringify({query:o,variables:a})}).then(e=>e.json()).then(e=>{if("error"===e.data.listChildComments.status)throw new Error(userfriendlymsg(e.data.listChildComments.ResponseCode));return e.data.listChildComments.affectedRows}).catch(e=>(console.error("Fehler:",e),null))}function getCookie(e){const t=`; ${document.cookie}`,n=t.split(`; ${e}=`);if(2===n.length)return n.pop().split(";").shift()}function createModal({title:e="",message:t="",buttons:n=[],type:o="info",textarea:a=!1,dontShowOption:r=!1,typeKey:s=null}){const i=JSON.parse(localStorage.getItem("modalDoNotShow"))||{};return s&&r&&!0===i[s]?Promise.resolve({button:1,dontShow:!0}):new Promise(l=>{const c=document.createElement("div");c.classList.add("modal-container");const d=r?'\n        <div class="modal-checkbox">\n          <label for="dont-show-checkbox">Do not show this message again</label>\n          <input type="checkbox" id="dont-show-checkbox" />\n        </div>':"";c.innerHTML=`\n      <div class="modal-content ${o}">\n        <span class="modal-close">&times;</span>\n        <h2 class="modal-title">${e}</h2>\n        <p class="modal-message">${t}</p>\n        ${d}\n        ${a?`<textarea class="modal-textarea" placeholder="${"object"==typeof a&&a.placeholder?a.placeholder:""}">${"object"==typeof a&&a.value?a.value:""}</textarea>`:""}\n        <div class="modal-buttons">\n          ${n.map((e,t)=>{const n="string"==typeof e?e:e.text,o="object"==typeof e&&e.className?` ${e.className}`:"";return`<button class="modal-button${o}" data-index="${t}">${n}</button>`}).join("")}\n        </div>\n      </div>\n    `,document.body.appendChild(c),setTimeout(()=>c.classList.add("modal-show"),10);const u=r?c.querySelector("#dont-show-checkbox"):null,m=c.querySelector(".modal-textarea"),f=c.querySelectorAll(".modal-button");f.forEach(e=>{e.addEventListener("click",e=>{const t=Number(e.target.getAttribute("data-index")),n=!!u&&u.checked;r&&n&&s&&1===t&&(i[s]=!0,localStorage.setItem("modalDoNotShow",JSON.stringify(i))),l(m?{button:t,value:m.value,dontShow:n}:r?{button:t,dontShow:n}:t),closeModal(c)})});const h=c.querySelector(".modal-close");h.addEventListener("click",()=>{const e=!!u&&u.checked;r&&e&&localStorage.setItem("modalDoNotShow","true"),l(r?{button:null,dontShow:e}:null),closeModal(c)}),c.addEventListener("click",e=>{if(e.target===c){const e=!!u&&u.checked;r&&e&&localStorage.setItem("modalDoNotShow","true"),l(r?{button:null,dontShow:e}:null),closeModal(c)}}),m&&setTimeout(()=>{m.focus()},10)})}function closeModal(e){e.classList.add("modal-fade-out"),setTimeout(()=>{e.remove()},300)}function userfriendlymsg(e){let t;return t=e in responsecodes.data?responsecodes.data[e].userFriendlyComment:e,t}function info(e,t="",n=!1){return createModal({title:e,message:userfriendlymsg(t),buttons:[{text:"Cancel",className:"btn-transparent"},{text:"Confirm",className:"btn-white"}],type:"info",dontShowOption:n})}function Merror(e,t="",n=!1){return createModal({title:e,message:userfriendlymsg(t),buttons:["OK"],type:"error",dontShowOption:n})}function warnig(e,t="",n=!1){return createModal({title:e,message:userfriendlymsg(t),buttons:[{text:"Cancel",className:"btn-transparent"},{text:"Confirm",className:"btn-white"}],type:"warning",dontShowOption:n})}function confirm(e,t="",n=!1,o=null){return createModal({title:e,message:userfriendlymsg(t),buttons:[{text:"Cancel",className:"btn-transparent"},{text:"Confirm",className:"btn-white"}],type:"warning",dontShowOption:n,typeKey:o})}function setScrollPercent(e,t,n=!1){const o=Math.min(100,Math.max(0,t)),a=e.scrollHeight-e.clientHeight,r=a*(o/100);n?e.scrollTo({top:r,behavior:"smooth"}):e.scrollTop=r}function formatNumber(e){return e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e.toString()}function sanitizeString(e){return e.replace(/[^A-Za-z0-9 \-_]/g,"")}function extractAfterComma(e){return e.includes(",")?e.split(",")[1]:e}async function loadTextFile(e,t){try{const n=await fetch(e),o=await n.text();t.innerText=o}catch(e){t.innerText="Fehler beim Laden der Datei."}}function sliceTextAtWord(e,t=140){if(e.length<=t)return e;const n=e.slice(0,t),o=n.lastIndexOf(" ");return n.slice(0,o)}async function readBytes(e,t){try{const n=await fetch(e),o=n.body.getReader(),{value:a,done:r}=await o.read();if(r)return;const s=a.slice(0,t),i=new TextDecoder("utf-8").decode(s);return i}catch(e){console.error("Fehler beim Lesen der Datei:",e)}}function formatDate(e){const t=new Date(e),n={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return t.toLocaleString("de-DE",n).replace(",","").replace(/\./g,".")}function timeAgo(e){const t=Date.now(),n=new Date(adjustForDSTAndFormat(e)),o=t-n-36e5,a=Math.floor(o/1e3),r=Math.floor(a/60),s=Math.floor(r/60),i=Math.floor(s/24),l=Math.floor(i/7),c=Math.floor(i/30),d=Math.floor(i/365);return a<60?`${a} second`+(a>1?"s ago":" ago"):r<60?`${r} minute`+(r>1?"s ago":" ago"):s<24?`${s} hour`+(s>1?"s ago":" ago"):i<7?`${i} day`+(i>1?"s ago":" ago"):l<4?`${l} week`+(l>1?"s ago":" ago"):c<12?`${c} month`+(c>1?"s ago":" ago"):`${d} year`+(d>1?"s ago":" ago")}function adjustForDSTAndFormat(e){const t={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},n=new Date(e.replace(" ","T")),o=new Date(n.getFullYear(),0,1),a=new Date(n.getFullYear(),6,1),r=Math.max(o.getTimezoneOffset(),a.getTimezoneOffset())!==n.getTimezoneOffset();return n.setHours(n.getHours()+1),r&&n.setHours(n.getHours()+1),n.toLocaleString(void 0,t).replace(",","").replace(/\./g,".")}function tempMedia(e){const t=domain.replace("://","://media.")+e;return t}async function fetchHelloData(e=null){const t=getCookie("authToken"),n=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${t}`});let o=JSON.stringify({query:`query Hello {\n      hello {\n          currentuserid\n      }\n      getProfile(userid: ${e}) {\n        status\n        ResponseCode\n        affectedRows {\n            id\n            username\n            status\n            slug\n            img\n            biography\n            isfollowed\n            isfollowing\n            amountposts\n            amounttrending\n            amountfollowed\n            amountfollower\n            amountfriends\n            amountblocked\n        }\n      }\n    }`,variables:{}});var a={method:"POST",headers:n,body:o,redirect:"follow"};try{const e=await fetch(GraphGL,a),t=await e.json();return console.log(t),t}catch(e){throw console.log("error",e),e}}async function hello(){const e=getCookie("authToken"),t=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${e}`}),n=JSON.stringify({query:"query Hello {\n      hello {\n          currentuserid\n      }\n  }"}),o={method:"POST",headers:t,body:n,redirect:"follow"};try{const e=await fetch(GraphGL,o),t=await e.json();if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);if(t.errors)throw new Error(t.errors[0].message);return document.cookie=`userID=${t.data.hello.currentuserid}; path=/; secure; SameSite=Strict`,t.data.hello}catch(e){throw console.error("Error:",e.message),e}}async function getUser(){const e=await fetchHelloData(),t=getCookie("userID");if(t){document.getElementById("username").innerText=e.data.getProfile.affectedRows.username,document.getElementById("slug").innerText="#"+e.data.getProfile.affectedRows.slug,document.getElementById("userPosts").innerText=e.data.getProfile.affectedRows.amountposts,document.getElementById("followers").innerText=e.data.getProfile.affectedRows.amountfollower,document.getElementById("following").innerText=e.data.getProfile.affectedRows.amountfollowed,document.getElementById("Peers")&&(document.getElementById("Peers").innerText=e.data.getProfile.affectedRows.amountfriends);const t=document.getElementById("profilbild");t.onerror=function(){this.src="svg/noname.svg"},t.src=e.data.getProfile.affectedRows.img?tempMedia(e.data.getProfile.affectedRows.img.replace("media/","")):"svg/noname.svg"}else{const e=document.getElementById("profil-container"),t=document.getElementById("profil-login");e.classList.add("none"),t.classList.remove("none")}return e}let domain=document.getElementById("config").dataset.host;const GraphGL=domain+"/graphql";let responsecodes=[];fetch("./json/response-codes.json").then(e=>e.json()).then(e=>{responsecodes=e});